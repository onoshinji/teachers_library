<% content_for(:title, 'ワークシート') %>
<div class="container-fluid">
  <div class="row">
<!-- 画面左側サイドバー -->
<nav class="col-md-2 d-none d-md-block sidebar">
  <div class="sidebar-sticky">
    <ul class="nav flex-column">
      <li class="nav-item">

          <%= form_with url: worksheets_path, method: :get, local: true do |form| %>
          <div class="grade_search">
          <span data-feather="file"></span>
            <%= form.label :学年 %>
            <%= form.select :grade_search, Post.grades.keys, selected: 1 %>
          </div>
          <div class="subject_search">
          <%= form.label :教科 %>
          <%= form.select :subject_search, Post.subjects.keys, include_blank: "指定しない" %>
          </div>
          <div class="col-row">
            <div class="col-12">
              <div class="unit_search">
                <% form.label :単元 %>
                <%= form.text_field :unit_search , class: "form-control form-control-sm", placeholder: "単元名"%>
              </div>
            </div>
          </div>
            <%= form.submit '検索する', name: nil , class: 'btn btn-primary btn-sm'%>
          <% end %>
          <%= form_with url: worksheets_path, method: :get, local: true do |form| %>
            <%= form.select("tag_id", Tag.pluck(:name, :id), { include_blank: true }) %>
            <%= form.submit 'タグ検索', name: nil , class: 'btn btn-info btn-sm'%>
          <% end %>
      </li>
    </ul>
  </div>
</nav>
    <!-- 画面右側に表示されるコンテンツ -->
    <main role="main" class="col-md-12 ml-sm-auto col-lg-10 px-4">
      <div class="align-items-center pt-3 pb-2 mb-3">
          <%= form_with  url: worksheets_path, method: :get, local: true do |form| %>
            <%= form.select :sort,{'新着順': 'new', '古い順': 'old', '閲覧数順': 'view', 'お気に入り順': 'favorites'},
                                  { include_blank: '',},
                                  { id: 'sort' , required: true } %>
            <%= form.submit '並び替え' ,class: 'btn btn-success btn-sm'%>
          <% end %>
      </div>
      <p id="notice"><%= notice %></p>
      <p class="alert"><%= alert %></p>

        <div class="row">
          <% @posts.each do |post| %>
          <div class="card" style="width: 15rem;">
            <div class="card-body">
              <p class="card-text">
                <span><%= "No. #{post.id}" %></span>
                <%= post.grade %><%= post.subject %><%= "  #{post.unit}" %>
              </p>
              <h4 class="bd-placeholder-img card-img-top" width="100%">
                <%= link_to image_tag(post.image.url(:thumb)), post_path(post.id) %>
              </h4>
                <ul class="list-inline">
                  <li class="list-inline-item">
                    <span><i class="fa fa-binoculars"></i><%= post.views_count %></span>
                    <span><i class="fa fa-heart"></i><%= post.favorites.count %></span>
                  </li>
                </ul>
                <% post.tags.each do |tag| %>
                  <span class= 'btn btn-info btn-sm rounded-pill'>
                    <%= tag.name %>
                  </span>
                <% end %>
            </div>
          </div>
          <% end %>
        </div>
          <%= paginate @posts %>
        </div>
      </div>
    </main>
  </div>
</div>
